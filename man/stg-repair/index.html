<!DOCTYPE html>
<html><head>
    <title>
         stg-repair(1) &ndash;  Stacked Git
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="theme-color" content="#ffffff">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="stylesheet" href="/css/stgit.css">
    <link rel="stylesheet" href="/css/chroma.css">
</head>
<body>
        <div><header>
  
  <a href="/">
    <img src="/stgit.svg" alt="Stacked Git logo">
  </a>
  
  <h3><a href="/">Stacked Git</a></h3>
  <nav>
    <ul>
      
      <li>
        <a href="/changelog/">
          
          Changelog
          
        </a>
      </li>
      
      <li>
        <a href="/man/">
          
          Man Pages
          
        </a>
      </li>
      
      <li>
        <a href="/guides/">
          
          Guides
          
        </a>
      </li>
      
      <li>
        <a href="/guides/tutorial/">
          
          Tutorial
          
        </a>
      </li>
      
      <li>
        <a href="https://github.com/stacked-git/stgit/">
          
          Repository
          <img src="/github.svg" alt="GitHub logo">
        </a>
      </li>
      
      <li>
        <a href="https://github.com/stacked-git/stgit/issues">
          
          Issue Tracker
          <img src="/github.svg" alt="GitHub logo">
        </a>
      </li>
      
      <li>
        <a href="https://github.com/stacked-git/stgit/releases">
          
          Releases
          <img src="/github.svg" alt="GitHub logo">
        </a>
      </li>
      
      <li>
        <a href="https://groups.google.com/d/forum/stgit">
          
          Forum
          <img src="/ext-link.svg" alt="external link">
        </a>
      </li>
      
    </ul>
  </nav>
</header>
<div>
<main>
  <h2>
    <a href="/man/stg-repair/">
      stg-repair(1)
    </a>
  </h2>






<div class="sect1">
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<div class="paragraph">
<p>stg-repair - Fix StGit metadata if branch was modified with git commands</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="verseblock">
<pre class="content"><em>stg repair</em></pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_description">DESCRIPTION</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you modify an StGit stack (branch) with some git commands — such
as commit, pull, merge, and rebase — you will leave the StGit
metadata in an inconsistent state. In that situation, you have two
options:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use &#34;stg undo&#34; to undo the effect of the git commands. (If you
know what you are doing and want more control, &#34;git reset&#34; or
similar will work too.)</p>
</li>
<li>
<p>Use &#34;stg repair&#34;. This will fix up the StGit metadata to
accommodate the modifications to the branch. Specifically, it will
do the following:</p>
<div class="ulist">
<ul>
<li>
<p>If you have made regular git commits on top of your stack of
StGit patches, &#34;stg repair&#34; makes new StGit patches out of
them, preserving their contents.</p>
</li>
<li>
<p>However, merge commits cannot become patches; if you have
committed a merge on top of your stack, &#34;repair&#34; will simply
mark all patches below the merge unapplied, since they are no
longer reachable. If this is not what you want, use &#34;stg
undo&#34; to get rid of the merge and run &#34;stg repair&#34; again.</p>
</li>
<li>
<p>The applied patches are supposed to be precisely those that
are reachable from the branch head. If you have used e.g.
&#34;git reset&#34; to move the head, some applied patches may no
longer be reachable, and some unapplied patches may have
become reachable. &#34;stg repair&#34; will correct the appliedness
of such patches.</p>
<div class="literalblock">
<div class="content">
<pre>&#34;stg repair&#34; will fix these inconsistencies reliably, so as long
as you like what it does, you have no reason to avoid causing
them in the first place. For example, you might find it
convenient to make commits with a graphical tool and then have
&#34;stg repair&#34; make proper patches of the commits.</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If using git commands on the stack was a mistake, running &#34;stg
repair&#34; is <em>not</em> what you want. In that case, what you want is option
(1) above.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stgit">StGit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Part of the StGit suite - see <a href="/man/stg">stg(1)</a></p>
</div>
</div>
</div>

</main>
<footer>
  <small>&copy; 2022 Stacked Git Authors</small>
</footer>
</div>
        </div>
    </body>
</html>
